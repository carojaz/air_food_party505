<%= render 'shared/navbar' %>
<div class="container">
  <h2 class="text-center pt-3">Your rentals</h2>
  <div>
    <% @rentals_done.each do |rental| %>
      <div class="container description-rental mb-3">
      <div class="device-name d-flex flex-row">
          <h2 class="pt-2"><%= rental.device.name %>
          <%= cl_image_tag rental.device.user.photo.key, :transformation=>[
  {:width=>400, :height=>400, :gravity=>"face", :radius=>"max", :crop=>"crop"},
  {:width=>200, :crop=>"scale"}
  ], class: "avatar " %>
          </h2>
      </div>
      <div class="description-look">
        <div class="user-info d-flex flex-row">
        <p><strong>Owner address :&nbsp</strong></p> <p class="pr-4"><%= rental.device.user.address %></p>
        <p><strong>Owner phone_number :&nbsp</strong></p> <p class="pr-4"><%= rental.device.user.phone_number %></p>
        </div>
        <div class="date-info d-flex flex-row">
        <p><strong>Price per day :&nbsp</strong></p> <p class="pr-4"><%= rental.device.price %></p>
        <p><strong>Start date :&nbsp</strong></p> <p class="pr-4"><%= rental.start_date.strftime('%d/%m/%Y') %></p>
        <p><strong>End date :&nbsp</strong></p><p class="pr-4"><%= rental.end_date.strftime('%d/%m/%Y') %></p>
        <p><strong>State :&nbsp</strong></p><p class="pr-4"><%= rental.state %></p>
        </div>
      </div>
      </div>
    <% end %>
  </div>

  <h2 class="text-center">Rentals on your devices</h2>
  <div>
    <% @rentals_on_user_device.each do |rental| %>
      <div class="container description-rental mb-3">
        <h2 class="pt-2"><%= rental.device.name %></h2>
      <div class="description-look">
        <div class="rental-on-ur-device d-flex flex-row">
        <p class= "d-flex align-items-center"><strong>Your device is rented by :&nbsp</strong></p>
        <p class="pr-4 d-flex align-items-center">
          <%= rental.user.full_name %>&nbsp &nbsp
          <%= cl_image_tag rental.user.photo.key, :transformation=>[
          {:width=>400, :height=>400, :gravity=>"face", :radius=>"max", :crop=>"crop"},
          {:width=>200, :crop=>"scale"}   
          ], class: "avatar " %>
        </p>
        </div>
        <div class="user-info d-flex flex-row">
        <p><strong>Owner address :&nbsp</strong></p> <p class="pr-4"><%= rental.device.user.address %></p>
        <p><strong>Owner phone_number :&nbsp</strong></p> <p class="pr-4"><%= rental.device.user.phone_number %></p>
        </div>
        <div class="date-info d-flex flex-row">
        <p><strong>Price per day :&nbsp</strong></p> <p class="pr-4"><%= rental.device.price %></p>
        <p><strong>Start date :&nbsp</strong></p> <p class="pr-4"><%= rental.start_date.strftime('%d/%m/%Y') %></p>
        <p><strong>End date :&nbsp</strong></p><p class="pr-4"><%= rental.end_date.strftime('%d/%m/%Y') %></p>
        <p><strong>State :&nbsp</strong></p><p class="pr-4"><%= rental.state %></p>
        <% if rental.state == "pending" %>
          <div class="accept-refuse">
            <%= link_to "Validate", validated_account_rental_path(rental), class:"btn btn-primary", method: :patch, data: { confirm: 'Are you sure?' } %>
            <%= link_to "Refuse", refused_account_rental_path(rental), class:"btn btn-danger", method: :patch, data: { confirm: 'Are you sure?' } %>
          </div>
        <% end %>
        </div>
      </div>
    </div>
    <% end %>
  </div>
</div>
<div>
  <%= render 'shared/footer' %>
</div>
